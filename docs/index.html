<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>jq-front: JSON with inheritance and templating</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>

/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
// For tabs
body {font-family: Arial;}

/* Style the tab */
.tab {
  overflow: hidden;
  border: 1px solid #ccc;
  background-color: #f1f1f1;
}

/* Style the buttons inside the tab */
.tab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
  font-size: 17px;
}

/* Change background color of buttons on hover */
.tab button:hover {
  background-color: #ddd;
}

/* Create an active/current tablink class */
.tab button.active {
  background-color: #ccc;
}

/* Style the tab content */
.tabcontent {
  display: none;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-top: none;
}
</style>
</head>
<body>
<div class="tab">
<button class="tablinks" onclick="location.href='https://github.com/dakusui/jq-front';">
  <img src="images/github.png" width="60px;20px" onclick="location.href = 'https://github.com/dakusui/jq-front';" align="middle"/>
</button>
<button class="tablinks" onclick="openTab(event, 'top')" id="defaultOpen">top</button>
<button class="tablinks" onclick="openTab(event, 'design')">design</button>
<button class="tablinks" onclick="openTab(event, 'faq')">faq</button>
<button class="tablinks" onclick="openTab(event, 'features')">features</button>
<button class="tablinks" onclick="openTab(event, 'installation')">installation</button>
<button class="tablinks" onclick="openTab(event, 'limitationsAndFutureWork')">limitationsAndFutureWork</button>
<button class="tablinks" onclick="openTab(event, 'manual')">manual</button>
<button class="tablinks" onclick="openTab(event, 'syntax')">syntax</button>
</div>
<div id="design" class="tabcontent">
<div id="design_content">
<div class="sect1">
<h2 id="_design">Design</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Following is a diagram that illustrates <code>jq-front</code> 's processing pipeline design.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pipeline.png" alt="pipeline" width="920" height="574">
</div>
<div class="title">Figure 1. jq-front’s pipeline</div>
</div>
<div class="paragraph">
<p>As shown, it consists of four main components, which are "file-level inheritance", "local node materialization", "node-level inheritance", and "templating".</p>
</div>
<div class="paragraph">
<p>Designs of those components will be described in the rest of this section.</p>
</div>
<div class="paragraph">
<p>For both of file-level and node-level inheritances, the inheritance mechanism (the large box in the diagram) is invoked recursively.
That is, when a file which has <code>$extends</code> attribute, the mechanism will be applied repeatedly until it reaches a file that doesn’t have any.
In case a cyclic inheritance is found, <code>jq-front</code> will report it and abort.</p>
</div>
<div class="sect2">
<h3 id="_file_level_inheritance">File-level Inheritance</h3>
<div class="paragraph">
<p>'File-level Inheritance' composes a new JSON file from a given one by expanding the files provided through the top-level <code>$extends</code> attribute.</p>
</div>
<div class="paragraph">
<p>At the end of this process, the attribute is removed and copied to the output, "Work(1)" in the diagram.</p>
</div>
</div>
<div class="sect2">
<h3 id="_local_node_materialization">Local node Materialization</h3>
<div class="paragraph">
<p>If the file, "Work(1)" has <code>$local</code> attribute whose value is an object node, nodes associated with keys under the attribute are dumped under a temporary directory.
The temporary directory is called 'local node directory'.
The 'local node directory' and its contents are utilized by the "node-level inheritance' mechanism.</p>
</div>
</div>
<div class="sect2">
<h3 id="_node_level_inheritance">Node-level Inheritance</h3>
<div class="paragraph">
<p>Node-level Inheritance mechanism is a bit more complicated than the file-level one.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a base JSON object by the following procedure.</p>
<div class="olist loweralpha">
<ol class="loweralpha">
<li>
<p>Scan paths of all internal nodes.</p>
</li>
<li>
<p>For each path, if it ends with <code>"$extends"</code>, expand the files specified by the attribute.</p>
</li>
<li>
<p>Assign the JSON node created in step b. to the parent of the <code>$extends</code> attribute.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Overlay the JSON object created in the step. 1 with an original JSON object.</p>
</li>
<li>
<p>Remove nodes, i.e., <code>$extends</code> and <code>$local</code> nodes from the JSON object created in the step 2.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>'Local node directory' is inserted before the first entry of <code>JF_PATH</code> environment variable when a file to be expanded is searched during the step 1. b.</p>
</div>
</div>
<div class="sect2">
<h3 id="_templating">Templating</h3>
<div class="paragraph">
<p>Templating is executed by performing <code>eval</code> on every text node whose value starts with <code>eval:</code> in a JSON object <code>Work(2)</code>.
The order where it is applied is determined by <code>jq</code> 's <code>path(..)</code> function.
Note that it is not defined in <code>jq</code> 's manual<a href="#jq">[jq]</a> how keys are sorted within an object node although they seem to be sorted by dictionary order.</p>
</div>
</div>
</div>
</div>
</div></div>
<div id="faq" class="tabcontent">
<div id="faq_content">
<div class="sect1">
<h2 id="_faq">FAQ</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_why_is_jq_front_so_slow">Why is jq-front so slow?</h3>
<div class="paragraph">
<p>It is because it’s written as a bash script and creates quite a lot of process an input file.
If somebody starts a project to rewrite this in Java, for instance, I would be contributing to it!</p>
</div>
</div>
<div class="sect2">
<h3 id="_how_is_error_handling_designed">How is error handling designed?</h3>
<div class="paragraph">
<p><code>jq-front</code> is designed and implemented so that it stops processing on errors.
However, due to the specification of <code>bash</code>, if you use command substitution in templating and an inner call occurs an error, it CANNOT stop.</p>
</div>
<div class="paragraph">
<p>Except for that, if you think it should stop but it doesn’t, please file a ticket <a href="https://github.com/dakusui/jq-front/issues">here</a>.</p>
</div>
<div class="paragraph">
<p>On errors, you should see an output like following.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ERROR: Malformed JSON was given:'/home/hiroshi/Documents/jq-front/tests/negative/malformed-node-inheritance/filelevel/M.json'='// MALFORMED'
  at 36 abort /home/hiroshi/Documents/jq-front/lib/shared.sh
  at 559 run_jqfront /home/hiroshi/Documents/jq-front/jq-front
  at 472 expand_filelevel_inheritances /home/hiroshi/Documents/jq-front/jq-front</pre>
</div>
</div>
</div>
</div>
</div>
</div></div>
<div id="features" class="tabcontent">
<div id="features_content">
<div class="sect1">
<h2 id="_features">Features</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With <code>jq-front</code>, you can build a JSON object reusing other JSON objects by its inheritance mechanism.
To specify JSON objects to be inherited, <code>jq-front</code> searches for keys which have special names in a given object.
<code>$extends</code> and <code>$local</code> are keywords used for this purpose.</p>
</div>
<div class="paragraph">
<p>Not only that, it allows you to construct a node by referencing other nodes and executing commands.</p>
</div>
<div class="paragraph">
<p>Basic features offered by the product are following</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inheritance</p>
<div class="ulist">
<ul>
<li>
<p>File-level Inheritance</p>
</li>
<li>
<p>Node-level Inheritance</p>
</li>
<li>
<p>Script-output Inheritance</p>
</li>
<li>
<p>Yaml inheritance</p>
</li>
</ul>
</div>
</li>
<li>
<p>Templating ("eval" feature)</p>
</li>
<li>
<p>Validation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And usage of them will be discussed in this section.</p>
</div>
<div class="paragraph">
<p>In this section, we introduce features of the product using following data.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="examples/A.json">A.json</a></p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": "A",
  "o": "A"
}</code></pre>
</div>
</div>
</li>
<li>
<p><a href="examples/AA.json">AA.json</a></p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$extends": [ "A.json" ],
  "aa": "AA"
}</code></pre>
</div>
</div>
</li>
<li>
<p><a href="examples/B.json">B.json</a></p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": "B",
  "o": "B"
}</code></pre>
</div>
</div>
</li>
<li>
<p><a href="examples/T.json">T.json</a></p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "versionStem": "2.12.0",
  "snapshotVersion": "eval:$(ref .versionStem)-SNAPSHOT"
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_inheritance">Inheritance</h3>
<div class="sect3">
<h4 id="_file_level_inheritance">File-level Inheritance</h4>
<div class="paragraph">
<p>In programming languages, inheritance is an indispensable technique to reuse a component.
<code>jq-front</code> offers it for the purpose.
A usage example is as follows.</p>
</div>
<div class="listingblock">
<div class="title">I.json</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$extends": [ "A.json" ],
  "o": "hello world"
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>jq-front I.json</pre>
</div>
</div>
<div class="paragraph">
<p><code>I.json</code> will be rendered into the following JSON object with this command line.</p>
</div>
<div class="listingblock">
<div class="title">File-level Inheritance output</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": "A",
  "o": "hello world"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you see in the example, the attribute <code>o</code> whose value is set to <code>"A"</code> in <code>A.json</code>, is overridden by the value in <code>I.json</code>.</p>
</div>
<div class="paragraph">
<p>Multiple inheritance is also supported by <code>jq-front</code>.
Just by listing file names of JSONs to be inherited, multiple inheritance happens, like <code>"$extends": ["A.json", "B.json"]</code>.
When both <code>A.json</code> and <code>B.json</code> have attributes at the same path, <code>A.json</code> side’s value will be used.</p>
</div>
<div class="listingblock">
<div class="title">J.json</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$extends": [ "A.json", "B.json" ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>That is, <code>J.json</code> will be rendered into following output.</p>
</div>
<div class="listingblock">
<div class="title">File-level Multiple Inheritance output</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": "A",
  "b": "B",
  "o": "A"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As it is so in normal programming language that supports multiple inheritance, avoiding diamond inheritance is a good idea.
Multiple inheritance was implemented to cope with a situation where you want to reuse two JSON objects defined for completely different purposes.
For instance, one is for authentication information and the other is for GUI flavor.</p>
</div>
<div class="paragraph">
<p>JSON objects that are inherited can also inherit some other JSON files.</p>
</div>
<div class="listingblock">
<div class="title">K.json</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$extends": [ "AA.json", "B.json" ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>That is, <code>K.json</code> is rendered into a following JSON file.</p>
</div>
<div class="listingblock">
<div class="title">File-level Inheritance output (2)</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": "A",
  "aa": "AA",
  "b": "B",
  "o": "A"
}</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
Ensure that inheritance hierarchy does not have any cyclic dependencies.
It will be checked and result in an error.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_node_level_inheritance">Node-level Inheritance</h3>
<div class="paragraph">
<p>"Node-level Inheritance" refers to an inheritance happens on an internal (object) node of a given JSON file.
Although it is implemented as a separate mechanism from the file-level one as it will be discussed in "Design" section, it behaves almost the same as the "file-level" one.</p>
</div>
<div class="listingblock">
<div class="title">L.json</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": {
    "$extends": [ "A.json" ],
    "a": "L"
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Node-level Inheritance output</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": {
    "a": "L",
    "o": "A"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As it worked for File-level Inheritance, multiple inheritance works also for Node-level Inheritance.</p>
</div>
<div class="paragraph">
<p>However, for internal nodes, you can also reference "local" nodes not only external files.</p>
</div>
<div class="listingblock">
<div class="title">P.json</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$local": {
    "nodeA": {
       "aa": "aa"
    },
    "nodeB": {
    }
  },
  "a": {
    "$extends": ["nodeA"],
    "a": "a"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>These nodes can be referenced through "node-level inheritance feature" as shown in the example.
Note that you do not need to specify <code>.json</code> extension.
And <code>P.json</code> will result in following output.</p>
</div>
<div class="listingblock">
<div class="title">Local Node Inheritance output</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": {
    "aa": "aa",
    "a": "a"
  }
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_script_inheritance">Script Inheritance</h4>
<div class="paragraph">
<p><code>jq-front</code> can use the output from your shell as a file to be extended if it is a JSON node.</p>
</div>
<div class="paragraph">
<p>For instance, if you have a following script file: <code>S.sh</code>, which prints something like <code>{"S":"shell"}</code>.</p>
</div>
<div class="listingblock">
<div class="title">S.sh</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">echo '{"S":"shell-'${1}'"}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output from the script can be extended by a following file, for instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "i": {
    "$extends": [
      "S.sh;bash -eu;hello"
    ],
    "o": "hello world"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This results in a file as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "i": {
    "S": "hello",
    "o": "hello world"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The component <code>bash -eu</code> is a program with which the script (<code>S.sh</code>) is executed.
This feature is still experimental.</p>
</div>
</div>
<div class="sect3">
<h4 id="_yaml_file_inheritance">Yaml file inheritance</h4>
<div class="paragraph">
<p><code>jq-front</code> can handle YAML files also.
If you have following two files,</p>
</div>
<div class="listingblock">
<div class="title">A.yml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">---
a: A
o: A
y: Y</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$extends": [ "A.yml" ],
  "o": "hello world"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output will be like following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": "A",
  "o": "hello world",
  "y": "Y"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This feature is still experimental.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_templating">Templating</h3>
<div class="paragraph">
<p>Sometimes we need to compose a value of text node from a value of another.
Following is a such an example.</p>
</div>
<div class="listingblock">
<div class="title">Version file</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "releaseVersion": "2.12.0",
  "snapshotVersion": "2.12.0-SNAPSHOT"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the version to be released next is <code>2.12.0</code>, however the version under the development for it has a suffix <code>-SNAPSHOT</code></p>
</div>
<div class="paragraph">
<p>To follow the principle of D-R-Y, how should we fix it?
Templating is a feature to offer a solution to this challenge.</p>
</div>
<div class="paragraph">
<p>We can describe this relationship by using the templating feature of <code>jq-front</code>.</p>
</div>
<div class="listingblock">
<div class="title">T.json</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "releaseVersion": "2.12.0",
  "snapshotVersion": "eval:$(ref .releaseVersion)-SNAPSHOT"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once you render this file with <code>jq-front</code>, you will get the first file (Version file).</p>
</div>
<div class="paragraph">
<p><code>$ref</code> is a built-in function of <code>jq-front</code>, which expands the value of the node specified by the path given as an argument.
Not only built-in functions but also any commands (bash expressions) valid on a platform on which <code>jq-front</code> is running can be used here.</p>
</div>
<div class="paragraph">
<p>For instance, following is a valid input to <code>jq-front</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "releaseVersion": "2.12.0",
  "snapshotVersion": "eval:$(ref .releaseVersion)-$(date \"+%Y-%m-%d\")"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And this will result in an output below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "releaseVersion": "2.12.0",
  "snapshotVersion": "2.12.0-2019-08-28"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This feature can be disabled by <code>-d</code> (<code>--disable-templating</code>) option.
And to enable it explicitly, you can use <code>-e</code> (<code>--enable-templating</code>) in case <code>JF_TEMPLATING_ENABLED</code> is set to <code>no</code>.</p>
</div>
</div>
</div>
</div>
</div></div>
<div id="installation" class="tabcontent">
<div id="installation_content">
<div class="sect1">
<h2 id="_installation">Installation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_ubuntu">Ubuntu</h3>
<div class="paragraph">
<p>Download an <a href="https://github.com/dakusui/jq-front/releases">archive</a> or clone the <a href="https://github.com/dakusui/jq-front.git">repository</a>.
And place the file <code>jq-front</code>, <code>lib</code>, and <code>schema</code> in a directory which is on your <code>PATH</code>.
Following dependencies will be required by <code>jq-front</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>bash</code></p>
</li>
<li>
<p><code>jq</code></p>
</li>
<li>
<p><code>ajv-cli</code></p>
<div class="ulist">
<ul>
<li>
<p><code>npm</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>yq</code></p>
<div class="ulist">
<ul>
<li>
<p>python-pip</p>
</li>
<li>
<p>python</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The version of <code>yq</code> installed through, <code>snap install yq</code> doesn’t work for <code>jq-front</code>.
Visit <a href="https://yq.readthedocs.io/en/latest/">yq</a> site to know it more.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
All the direct and indirect dependencies are found in the <code>Dockerfile</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_with_docker_recommended">With Docker (recommended)</h3>
<div class="paragraph">
<p>If you are already using <code>docker</code> and <code>bash</code>, this is the easiest way to use <code>jq-front</code>.
To install docker, visit</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.docker.com/docker-for-windows/">windows</a></p>
</li>
<li>
<p><a href="https://docs.docker.com/docker-for-mac/install/">mac</a></p>
</li>
<li>
<p><a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/">ubuntu</a></p>
</li>
<li>
<p><a href="https://docs.docker.com/install/linux/docker-ce/centos/">centos</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Add a following entry to your <code>.bashrc</code> or a file sourced through it (such as <code>.profile</code> on Mac OSX).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell script" data-lang="shell script">function jq-front() {
  docker run --rm -i \
    -v /:/var/lib/jf \
    -e JF_PATH_BASE="/var/lib/jf" \
    -e JF_PATH="${JF_PATH}" \
    -e JF_DEBUG=${JF_DEBUG:-disabled} \
    -e JF_CWD="$(pwd)" \
    dakusui/jq-front:"${JF_DOCKER_TAG:-v0.25}" "${@}"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To install <code>bash</code> on windows, <a href="https://itsfoss.com/install-bash-on-windows/">install-bash-on-windows</a> will be helpful.</p>
</div>
</div>
</div>
</div>
</div></div>
<div id="limitationsAndFutureWork" class="tabcontent">
<div id="limitationsAndFutureWork_content">
<div class="sect1">
<h2 id="_limitations_and_future_work">Limitations and Future Work</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/dakusui/jq-front/issues">Issues</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_make_it_faster">Make it faster</h3>
<div class="paragraph">
<p>The largest weakpoint of <code>jq-front</code> is its performance.
It takes seconds to process even a relatively simple and small file.</p>
</div>
<div class="paragraph">
<p>However, trying to make <code>jq-front</code> faster sacrificing the readability of it doesn’t seem to me a good idea, especially in case it is written in a language which is generally considered "hard to read and debug".</p>
</div>
<div class="paragraph">
<p>Instead, we should think of implement it in another language, which is performance-wise more powerful and optimized, such as Java, C#, or whatsoever.</p>
</div>
<div class="sect3">
<h4 id="_design_consideration">Design consideration</h4>
<div class="ulist">
<ul>
<li>
<p>Path in JSON</p>
</li>
<li>
<p>Implementing the 'templating' feature.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_path_in_json">Path in JSON</h5>
<div class="paragraph">
<p>To implement a processor like <code>jq-front</code> requires a notation to specify a certain point in a JSON node as a string.</p>
</div>
<div class="paragraph">
<p><code>jq</code> has such as feature out-of-box.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "a": {
       "b": 123,
       "c": ["HELLO"]
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The string <code>HELLO</code> in the array in the example above can be specified by a string <code>.a.c[0]</code>.</p>
</div>
<div class="paragraph">
<p>We need to choose a library that can do this sort of work or implement such a functionality by ourselves.</p>
</div>
</div>
<div class="sect4">
<h5 id="_implementing_the_templating_feature">Implementing the 'templating' feature</h5>
<div class="paragraph">
<p>In order to implement the 'templating' feature, we need to be able to handle a string like following.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    "eval:object:{"hello":"$(ref .root.greeting[0].english)"}</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div></div>
<div id="manual" class="tabcontent">
<div id="manual_content">
<div class="sect1">
<h2 id="_usage">Usage</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_command_line_interface">Command Line Interface</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">jq-front [-h|--help] [-e|--enable-templating] [-d|--disable-templating] [--validation=no|strict|lenient] [TARGET]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-h</code>, <code>--help</code>: Shows a help</p>
</li>
<li>
<p><code>-e</code>, <code>--enable-templating</code>: Enables templating (default)</p>
</li>
<li>
<p><code>-d</code>, <code>--disable-templating</code>: Disables templating</p>
</li>
<li>
<p><code>--validation</code>: Validation mode.
<code>no</code>, <code>strict</code>, and <code>lenient</code> are available.
The default is <code>no</code>.</p>
</li>
<li>
<p><code>TARGET</code>: A file to be processed.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_environment_variables">Environment variables</h3>
<div class="paragraph">
<p>You can control behaviours of <code>jq-front</code> by setting environment variables described in this section.</p>
</div>
<div class="sect3">
<h4 id="_jf_path">JF_PATH</h4>
<div class="paragraph">
<p>From directories listed in <code>JF_PATH</code>, <code>jq-front</code> searches for requested file.
Entries in the variable are separated by colons(<code>:</code>).</p>
</div>
<div class="paragraph">
<p>When it is searching for a file during node-level inheritance resolution, it first searches for local node directory, which is created for temporarily, and if nothing is found, it will then traverses the variable.</p>
</div>
<div class="sect4">
<h5 id="_default_value">Default value</h5>
<div class="paragraph">
<p><code>.</code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jf_templating_enabled">JF_TEMPLATING_ENABLED</h4>
<div class="paragraph">
<p>You can enable <code>jq-front</code> 's templating feature by setting this environment variable’s value to <code>yes</code>.
If any other value is set to the variable, it will not be executed.</p>
</div>
<div class="sect4">
<h5 id="_default_value_2">Default value</h5>
<div class="paragraph">
<p><code>yes</code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jf_debug">JF_DEBUG</h4>
<div class="paragraph">
<p>If this variable is set to <code>enabled</code>, debug information will be printed to <code>stderr</code>.</p>
</div>
<div class="sect4">
<h5 id="_default_value_3">Default value</h5>
<div class="paragraph">
<p><code>disabled</code></p>
</div>
</div>
</div>
</div>
</div>
</div>
</div></div>
<div id="syntax" class="tabcontent">
<div id="syntax_content">
<div class="sect1">
<h2 id="_syntax">Syntax</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_extends_keyword"><code>$extends</code> keyword</h3>
<div class="paragraph">
<p>This keyword can be used as a key whose associated value is an array.
Each element in the array must be a text node.</p>
</div>
<div class="paragraph">
<p>The string can be one of</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A file in <code>JF_PATH</code>.</p>
</li>
<li>
<p>When it is placed NOT at the top level of an object node file, a name of a "local node".</p>
</li>
<li>
<p>A script invocation directive.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To create a JSON file from an existing one <code>A.json</code>, you can do following.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$extends": [ "A.json" ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you see in the example, the name of the file is placed inside an array and it means you can do so called "multiple-inheritance".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$extends": [ "A.json", "B.json" ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you do a multiple inheritance, an element appeared in the array earlier is more prioritized(similar to the multiple inheritance in python).</p>
</div>
<div class="paragraph">
<p>In case you have nodes at the same path in <code>A.json</code> and <code>B.json</code>, value from the <code>A.json</code> wins.</p>
</div>
<div class="sect3">
<h4 id="_file_in_jf_path">File in <code>JF_PATH</code></h4>
<div class="paragraph">
<p>As long as your file is under a directory specified by an element in <code>JF_PATH</code>, you can use it.
That is, suppose that you have <code>JF_PATH</code> and it has a value <code>.:dir1</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>dir1
 |
 `--- child
      |
      `--- J.json</pre>
</div>
</div>
<div class="paragraph">
<p>The file <code>J.json</code> can be referenced by</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"$extends": ["child/J.json"]</pre>
</div>
</div>
<div class="paragraph">
<p>In case you have <code>child/J.json</code> in multiple places under elements in <code>JF_PATH</code>, the first one will be used.
For instance, in the following example, <code>dir1/child/J.json</code> will be referenced for the example abobe.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>dir1
 +--- child
 |    |
 |     `--- J.json
dir2
 |
 `--- child
      |
      `--- J.json</pre>
</div>
</div>
<div class="paragraph">
<p>You can also specify names of "local nodes".
(See the section for <code>$local</code> keyword)</p>
</div>
</div>
<div class="sect3">
<h4 id="_inheriting_yaml_files">Inheriting YAML files</h4>
<div class="paragraph">
<p>You can specify a file on <code>JF_PATH</code> environment variable.
If the name ends with <code>.yaml</code> or <code>.yml</code>, it will be treated as a YAML file and converted into a JSON file by <code>yq</code> command.</p>
</div>
<div class="paragraph">
<p>This feature is still experimental.</p>
</div>
</div>
<div class="sect3">
<h4 id="_script_invocation_directive">Script Invocation Directive</h4>
<div class="paragraph">
<p>You can specify a program which generates a JSON object with a following syntax.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$extends": [
    "SS.sh;bash -eu;dir1/J.json"
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>SS.sh</code> is a script file to be executed.
<code>bash -eu</code> is a program which executes the script.
<code>dir1/J.json</code> is an argument which is passed to the program <code>SS.sh</code>.</p>
</div>
<div class="paragraph">
<p>The string is split by semicolons and the first token is treated as a name of a program to be executed.
The program is searched from <code>JF_PATH</code>.
The second toke is a shell with which the program is executed.
And the rest will be passed to the program as arguments.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
By inserting one or more semicolons, this syntax is triggred.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_local_keyword"><code>$local</code> keyword</h3>
<div class="paragraph">
<p>This keyword can be used as a key whose associated value is an object.
A value in the object must be an object.</p>
</div>
<div class="paragraph">
<p>This keyword can only be placed at the top-level of a file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$local": {
    "A": {
      "a": "valueInA"
    },
    "B": {
      "b": "valueInB"
    },
    "C": {
      "$extends": ["A","B"]
    }
  },
  "D": {
    "$extends": ["C"]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, local nodes <code>A</code>, <code>B</code>, and <code>C</code> are defined.
And a node at the top level, <code>D</code> extends <code>C</code>, which then extends <code>A</code> and <code>B</code>.
This results in a following JSON object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "D": {
    "a": "valueInA",
    "b": "valueInB"
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In case you have a local node and a file with the same name, <code>jq-node</code> picks up a local node, although you do not need to mind it usually because you do not want to give a suffix <code>.json</code> to a local node.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_eval_keyword"><code>eval:</code> keyword</h3>
<div class="paragraph">
<p>This keyword can be used in a text node.
The syntax can be defined as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>  eval:[TYPE:]STRING
  TYPE ::= object array string number boolean</code></pre>
</div>
</div>
<div class="paragraph">
<p>If <code>TYPE:</code> is omitted, in other words <code>eval:</code> is followed by anything else than the defined <code>TYPE`s, `jq-front</code> behaves as if <code>string</code> is specified.</p>
</div>
<div class="paragraph">
<p>The <code>STRING</code> is evaluated by a following command line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">    eval "echo \"${_body}\"" 2&gt;"${_error}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>As seen in the above fragment, stderr is redirected to an internal file and the file is checked if a string <code>ERROR: </code> is contained in it.
If the string is found in it, <code>jq-front</code> considers that something went wrong during the evaluation and aborts the rest of the process.
Such a string is printed to stderr by <code>error</code> function (See its definition in <a href="#builtin-functions">Built-in <code>jq-front</code> functions</a> section).</p>
</div>
<div class="paragraph">
<p>Not only variables, functions, and commands visible to a bash shell on which <code>jq-front</code> runs, you can use functions provided by the processor.
For more details, refer to <a href="#builtin-functions">Built-in <code>jq-front</code> functions</a> section.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
There are similar keywords <code>template:</code>, but it is only kept for compatibility and will be removed in the future version of this product.
Please refrain from using it.
In case you want to define a text node that starts with the string itself, you can do <code><code>raw:template:…​</code></code>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_raw_keyword"><code>raw:</code> keyword</h3>
<div class="paragraph">
<p>You may sometimes want to define a text node which starts with other keywords such as <code>eval:</code> itself.
In such cases you can use <code>raw:</code> keyword to escape it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>   raw:eval:hello</code></pre>
</div>
</div>
<div class="paragraph">
<p>This results in a following output.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>   eval:hello</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_template_keyword"><code>template:</code> keyword</h3>
<div class="paragraph">
<p>Deprecated.
A keyword that has similar effects to <code>eval:</code> keyword.
This is kept only for compatibility.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="builtin-functions">Built-in <code>jq-front</code> functions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In addition to commands and functions visible to a bash shell on which <code>jq-front</code> runs, you can use functions listed in this section.</p>
</div>
<div class="sect2">
<h3 id="_ref_function"><code>ref</code> function</h3>
<div class="paragraph">
<p>A function that returns a value of a node specified by an argument.
This function can only work from inside "Work(2)" file.</p>
</div>
<div class="paragraph">
<p>In case this function references a text node that starts with <code>eval:</code>, it performs templating on the node.
This means, the <code>ref</code> function may be applied recursively.
In case cyclic reference is found during this process, it will be reported and the process will be aborted.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>parameter:</p>
<div class="ulist">
<ul>
<li>
<p><code>_path</code>: path to a node in the file "Work(2)"</p>
</li>
</ul>
</div>
</li>
<li>
<p>returned value (stdout):</p>
<div class="ulist">
<ul>
<li>
<p>A value of a node specified by <code>_path</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_examples">Examples</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Input</th>
<th class="tableblock halign-left valign-top">Output</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="title">A.json</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": {
    "b": {
       "c": "hello"
    }
  },
  "r": "eval:string:$(ref .a.b.c), world"
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": {
    "b": {
       "c": "hello"
    }
  },
  "r": "hello, world"
}</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="title">B.JSON</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$extends": ["A.json"],
  "r": "eval:string:$(ref .a.b.c), world"
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": {
    "b": {
       "c": "hello"
    }
  },
  "r": "hello, world"
}</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="title">C.JSON</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$extends": ["A.json"],
  "r": "eval:object:$(ref .a.b)"
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": {
    "b": {
       "c": "hello"
    }
  },
  "r": {
    "c": "hello"
  }
}</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_self_function"><code>self</code> function</h3>
<div class="paragraph">
<p>A function that prints the entire file content before templating.
This function is intended for internal use.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>parameter: (none)</p>
</li>
<li>
<p>returned value (stdout):</p>
<div class="ulist">
<ul>
<li>
<p>Content of the processed file before any templating happens.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_curn_function"><code>curn</code> function</h3>
<div class="paragraph">
<p>A function that returns a path to the node that makes a call to this function.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>parameter: (none)</p>
</li>
<li>
<p>returned value (stdout):</p>
<div class="ulist">
<ul>
<li>
<p>A path to the string node that makes the call to this function.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_examples_2">Examples</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Input</th>
<th class="tableblock halign-left valign-top">Output</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="title">A.json</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": {
    "b": [
       "eval:$(curn)"
    ]
  }
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": {
    "b": [
       ".a.b[0]"
    ]
  }
}</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="title">A.json</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": {
    "b": {
       "c": "eval:$(cur)"
    }
  }
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": {
    "b": {
       "c": ".a.b.c"
    }
  }
}</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The actual outputs of this function are escaped.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cur_function"><code>cur</code> function</h3>
<div class="paragraph">
<p>A function that returns a path to a container node to which the current "entry" belongs.
An "entry" means a string element in an array or a pair of key and value in an object.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>parameter: (none)</p>
</li>
<li>
<p>returned value (stdout):</p>
<div class="ulist">
<ul>
<li>
<p>A path to the container the node belongs to</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_examples_3">Examples</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Input</th>
<th class="tableblock halign-left valign-top">Output</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="title">A.json</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": {
    "b": [
       "eval:$(cur)"
    ]
  }
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": {
    "b": [
       ".a.b"
    ]
  }
}</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="title">A.json</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": {
    "b": {
       "c": "eval:$(cur)"
    }
  }
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "a": {
    "b": {
       "c": ".a.b"
    }
  }
}</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="title">X.JSON</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "x": {
    "$extends": ["A.json"]
  }
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "x": {
    "a": {
      "b": {
         "c": ".x.a.b"
      }
    }
  }
}</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Notice that jq-front first expands all the inheritances in the input and then invokes the 'templating' mechanism.
Thus, <code>cur</code> function calls in inherited files are evaluated based on paths where they appear in the expanded file.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_parent_function"><code>parent</code> function</h3>
<div class="paragraph">
<p>A function that prints a path to a parent node of a given path.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>parameter:</p>
<div class="ulist">
<ul>
<li>
<p>A path to a node</p>
</li>
</ul>
</div>
</li>
<li>
<p>returned value (stdout):</p>
<div class="ulist">
<ul>
<li>
<p>A path to a parent of the node.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_examples_4">Examples</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Input</th>
<th class="tableblock halign-left valign-top">Output</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"eval:$(parent .hello.world)"</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">".hello"</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_error_function"><code>error</code> function</h3>
<div class="paragraph">
<p>A function that prints a given error message and returns a non-zero value.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>parameter:</p>
<div class="ulist">
<ul>
<li>
<p>An error message</p>
</li>
</ul>
</div>
</li>
<li>
<p>returned value:</p>
<div class="ulist">
<ul>
<li>
<p>stdout</p>
<div class="ulist">
<ul>
<li>
<p>(none)</p>
</li>
</ul>
</div>
</li>
<li>
<p>sterr</p>
<div class="ulist">
<ul>
<li>
<p>A string starts with <code><code>ERROR: {given error message}</code></code>.
A stack trace follows it.</p>
</li>
</ul>
</div>
</li>
<li>
<p>exit code</p>
<div class="ulist">
<ul>
<li>
<p>A non-zero value.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you nest a call to a function or command that fails by another using a command substitution of <code>bash</code>, the next call will not be aborted immediately, in general.
That is, <code><code>"eval:$(echo $(cat missing-file))-$(echo hello)"</code></code> will result in <code>-hello</code>.
This is a behaviour of <code>bash</code> and its command substitution.
However, if you use this function, <code><code>"eval:$(echo $(cat missing-file || error 'something went wrong'))-$(echo hello)"</code></code>, <code>jq-front</code> will abort the process after evaluating this string because it finds a keyword <code><code>ERROR: </code></code> in the stderr.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Functions discussed in this section check whether <code>$?</code> is zero at the beginning.
If it is not zero, the function will abort and the string evaluation will be aborted in general.
However, a user is still able to nest the call with another function that not necessarily performs such a check.
In this case, the evaluation will not stop at the point and <code>jq-front</code> will abort the rest of its execution after handling the string since it will find the <code><code>ERROR: </code></code> keyword.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_examples_5">Examples</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Input</th>
<th class="tableblock halign-left valign-top">Output</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"eval:$(error hello)"</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">ERROR: hello
  at 36 abort /home/who/Documents/jq-front/lib/shared.sh
  at 439 _check_cyclic_dependency /home/who/Documents/jq-front/jq-front
  at 111 _expand_nodelevel_inheritances /home/who/Documents/jq-front/jq-front
...</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="user-functions">Defining a user function for templating</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can define your own function for the templating stage by following syntax.
First, you can create a file that contains definitions of your functions.</p>
</div>
<div class="listingblock">
<div class="title">SS.sh</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">function hello_world() {
  echo "Hello, world. My Function!"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next you reference the file inside the <code>$extends</code> syntax.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "$extends": [
    "SS.sh;SOURCE"
  ],
  "key": "eval:string:hello_world=$(hello_world),$(echo HELLO)"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The string <code>SOURCE</code> is the keyword that tells <code>jq-front</code> to import the file.
And as you see, you are now able to call the function you defined, <code>hello_world</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "key": "hello_world=Hello, world. My Function!,HELLO"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The file will be rendered as you see above.</p>
</div>
</div>
</div>
</div></div>
<div id="top" class="tabcontent">
<div id="top_content">
<div class="sect1">
<h2 id="_jq_front_json_with_inheritance_and_templating"><code>./</code> jq-front: JSON with inheritance and templating</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://github.com/dakusui/jq-front"><code>jq-front</code></a> is a simple tool to give your JSON files a power of inheritance and templating.
It was named after <strong>Cfront</strong><a href="#Cfront">[2]</a>, which is an old component of C++ language that converts C++ source code into C language.</p>
</div>
<div class="paragraph">
<p>Despite that there are criticisms to use JSON<a href="#json">[5]</a> as system configuration information’s format<a href="#cr">[3]</a>, JSON still has its beauty such as rich tool supports, good balance between machine’s and human’s readability and writability, clarity and simplicity in syntax, etc.</p>
</div>
<div class="paragraph">
<p>However, surely it has some weaknesses when we try to define data structure.
For instance, under a situation, where we need to generate similar but slightly different system configurations repeatedly, it is quite difficult to remove redundant pieces since JSON itself does not define anything about relationships between files or nodes inside files.<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</div>
<div class="sect2">
<h3 id="_for_what_is_it_useful">For what is it useful?</h3>
<div class="paragraph">
<p>Haven’t you ever created configuration files, each of which are slightly different?</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">config for foo</th>
<th class="tableblock halign-left valign-top">config for bar</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "foo_database": {
    "server": {
      "ip": "192.168.1.5",
      "port": 2001
    },
    "db_name": "foo",
    "user": {
      "name": "root",
      "password": "foo_root"
    }
  }
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "bar_database": {
    "server": {
      "ip": "192.168.1.5",
      "port": 2001
    },
    "db_name": "bar",
    "user": {
      "name": "root",
      "password": "bar_root"
    }
  }
}</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Probably you want to define a JSON, which defines boring default values like this,</p>
</div>
<div class="listingblock">
<div class="title">database_default</div>
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "server": {
      "ip": "192.168.1.5",
      "port": 2001
    },
    "user": {
      "name": "root"
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And reuse it from other files as follows</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">foo.json</th>
<th class="tableblock halign-left valign-top">bar.json</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "foo_database": {
    "$extends": [ "database_default.json" ],
    "db_name": "foo",
    "user": {
      "password": "foo_root"
    }
  }
}</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "foo_database": {
    "$extends": [ "database_default.json" ],
    "db_name": "bar",
    "user": {
       "password": "bar_root"
    }
  }
}</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>jq-front</code> does it for you.
Try <code>jq-front foo.json</code> from your command line and you will see the <code>config for foo</code> in the first matrix.</p>
</div>
</div>
<div class="sect2">
<h3 id="_yaml">YAML?</h3>
<div class="paragraph">
<p>There is a criticism to use JSON as a configuration language<a href="#cr">[3]</a>.
Although I am a bit skeptical at the discussion from some view points (e.g., users will eventually end up in desiring GUI not only YAML), <code>jq-front</code> can also be used to make your YAML based configuration language more powerful.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">INPUT</th>
<th class="tableblock halign-left valign-top">OUTPUT</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">$local:
  database_default:
    server:
      ip: 192.168.1.5
      port: 2000
    db_name: test
    user:
      name: root
      password: root

# database foo differs from default by only its port and user password
foo_database:
  $extends: [ database_default ]
  server:
    port: 2001
  db_name: foo
  user:
    password: foo_root</code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">foo_database:
  server:
    ip: 192.168.1.5
    port: 2001
  db_name: foo
  user:
    name: root
    password: foo_root</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The command line to render the input is following.<a href="#stackoverflow">[7]</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell script" data-lang="shell script">$ yq . -j in.yaml | jq-front  | yq . -y</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references">References</h2>
<div class="sectionbody">
<div class="ulist bibliography">
<ul class="bibliography">
<li>
<p><a id="jq-front"></a>[1] jq-front project in github.org. <a href="https://github.com/dakusui/jq-front">jq-front</a>:
2019</p>
</li>
<li>
<p><a id="Cfront"></a>[2] Cfront article in en.wikipedia.org. <a href="https://en.wikipedia.org/wiki/Cfront">Cfront</a>:
2019</p>
</li>
<li>
<p><a id="cr"></a>[3] Thayne McCombs. <a href="https://www.lucidchart.com/techblog/2018/07/16/why-json-isnt-a-good-configuration-language/">Why JSON isn’t a Good Configuration Language</a>:
2018.</p>
</li>
<li>
<p><a id="yaml"></a>[4] YAML article in en.wikipedia.org. <a href="https://en.wikipedia.org/wiki/YAML">YAML</a>:
2019</p>
</li>
<li>
<p><a id="json"></a>[5] json.org. <a href="http://www.json.org/">JSON</a>:2019</p>
</li>
<li>
<p><a id="jq"></a>[6]  jq <a href="https://stedolan.github.io/jq/manual/">jq manual</a>:2019</p>
</li>
<li>
<p><a id="stackoverflow"></a>[7] More complex inheritance in YAML? <a href="https://stackoverflow.com/questions/14184971/more-complex-inheritance-in-yaml">stackoverflow</a>:2019</p>
</li>
</ul>
</div>
</div>
</div>
</div></div>
<script>
function openTab(evt, cityName) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(cityName).style.display = "block";
  evt.currentTarget.className += " active";
}

// Get the element with id="defaultOpen" and click on it
document.getElementById("defaultOpen").click();

</script>
</body>
</html>
